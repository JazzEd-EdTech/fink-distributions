# -*- coding: ascii; tab-width: 4; x-counterpart: sip-py.patch -*-
Info2: <<

Package: sip-py%type_pkg[python]
Version: 4.19.24
Revision: 1
Type: python (2.7 3.4 3.5 3.6 3.7 3.8)

# SF source has not been updated since 4.19.13
# Source: mirror:sourceforge:pyqt/sip/sip-%v/sip-%v.tar.gz
Source: https://www.riverbankcomputing.com/static/Downloads/sip/%v/sip-%v.tar.gz
Source-Checksum: SHA256(edcd3790bb01938191eef0f6117de0bf56d1136626c0ddb678f3a558d62e41e5)

GCC: 4.0
Depends: python%type_pkg[python]
BuildDepends: fink-buildenv-modules (>= 0.1.3-1), fink (>= 0.24.12-1)
BuildDependsOnly: false

PatchFile: %{ni}.patch
PatchFile-MD5: d08dcb0733f7f0bc886672b22777dbf9

UseMaxBuildJobs: true
CompileScript: <<
	#!/bin/sh -ev
	. %p/sbin/fink-buildenv-helper.sh
 	%p/bin/python%type_raw[python] configure.py \
 		--no-module \
		--no-dist-info \
		-p macx-g++ \
		-v %p/share/sip-py%type_pkg[python] \
		INCDIR_OPENGL=$X11_INCLUDE_DIR \
		LFLAGS_PLUGIN="-bundle `%p/bin/python%type_raw[python]-config --ldflags`"
	perl -pi -e 's,exe = \"python.*,exe = \"%p/bin/python\",g' sipconfig.py
	make
<<

InstallScript: <<
	#!/bin/bash -ev
	make install DESTDIR=%d
	cd %i/lib/python%type_raw[python]/site-packages
	mv %i/bin/sip %i/bin/sip-py%type_pkg[python]
	%p/bin/python%type_raw[python] -m compileall .
<<

SplitOff: <<
	Package: %N-bin
	Depends: sip-py%type_pkg[python] (= %v-%r)
	Conflicts: <<
		sip-py27-bin (<< 4.19.22), sip-py34-bin (<< 4.19.22), sip-py35-bin (<< 4.19.22), sip-py36-bin (<< 4.19.22), sip-py37-bin (<< 4.19.22)
	<<
	Replaces: <<
		sip-py27-bin (<< 4.19.22), sip-py34-bin (<< 4.19.22), sip-py35-bin (<< 4.19.22), sip-py36-bin (<< 4.19.22), sip-py37-bin (<< 4.19.22)
	<<
	Files: bin
	DocFiles: LICENSE* NEWS README
	License: GPL
	PostInstScript: <<
		# Remove old link if it exists
		update-alternatives --auto sip
		update-alternatives --verbose --install %p/bin/sip sip %p/bin/sip-py%type_pkg[python] %type_pkg[python]

		echo ""
		echo "The 'sip' executable installed in %p/bin/ is a symlink automatically updated"
		echo "by the update-alternatives utility. If you install multiple flavours of the"
		echo "sip package the symlink will point to the higher flavour by default."
	<<

	PreRmScript: <<
		if [ $1 != "upgrade" ]; then
			update-alternatives --verbose --remove sip %p/bin/sip-py%type_pkg[python]
		else
			echo "Skipping update-alternatives during an upgrade."
		fi
	<<
<<


DocFiles: LICENSE* NEWS README ChangeLog doc/html

DescPackaging: <<
	Disable requirement of framework-built python on darwin.
	Don't over-ride specs/ for plugin compiler flags on darwin.
	
	Previously maintained by Dave Reiser <dbreiser@users.sourceforge.net>
	Manage -bin SplitOffs with update-alternatives.
<<
Description: Create Python bindings for C and C++ Libs
Homepage: http://www.riverbankcomputing.co.uk/software/sip/intro
License: GPL
Maintainer: Daniel Johnson <daniel@daniel-johnson.org>

<<
